AI-NutriCurator/ # 📦 전체 프로젝트(“한 서비스”)
├─ README.md # 📄📢 사용법/실행법/팀 규칙 정리 (팀 모두)
├─ docker-compose.yml # 🐳🧩 DB/서버 한 번에 켜기 (백엔드)
├─ .env.example # 🔐🧾 환경변수 예시(키/DB주소) (백엔드)
├─ pyproject.toml # 📌📦 파이썬 패키지 목록/설정 (백엔드)
├─ alembic.ini # 🗃️⚙️ DB 테이블 변경 기록 관리 설정 (백엔드)
├─ alembic/ # 🗂️🗃️ DB 테이블 변경 기록(마이그레이션)
│ ├─ env.py # 🔌⚙️ DB 연결/실행 설정 (백엔드)
│ └─ versions/ # 🧱📚 테이블 변경 파일들이 쌓이는 곳 (백엔드)
├─ scripts/ # 🛠️⏯️ 한번만 돌리는 작업(데이터 넣기 등)
│ ├─ seed_demo_data.py # 🌱👤🛒 데모 유저/상품 데이터 넣기 (백엔드)
│ └─ build_vector_index.py # 🧠🔍 (선택) 검색용 인덱스 만들기 (RECO Agent 담당)
├─ tests/ # ✅🧪 자동 테스트
│ ├─ test_rules.py # ⚖️✅ 룰 코드 검사 (Rule 담당)
│ ├─ test_reco.py # 🔍✅ 후보 검색/정렬 검사 (RECO Agent 담당)
│ ├─ test_substitution.py # 🔁✅ 대체안 생성/필터/점수화 검사 (Substitution 담당)
│ ├─ test_cart.py # 🧺✅ (옵션/MVP X) 장바구니 합산/위반 검사 (CART 담당)
│ ├─ test_orchestrator.py # 🧭✅ “LLM 없이 분기 호출” 흐름 검사 (Orchestrator 담당)
│ ├─ test_api.py # 🌐✅ API 호출 테스트 (백엔드)
│ └─ test_tools.py # 🧰✅ “도구 함수들” 테스트 (USER/RECO/Sub/CART/Rule 공용)
└─ app/ # 🚀🏠 실제 서비스 코드(메인)
├─ main.py # ▶️🧭 서버 시작점(라우터 연결) (백엔드)
├─ settings.py # ⚙️🔐 환경변수 읽어서 설정 만들기 (백엔드)
├─ logging.py # 🧾🕵️ 기록 남기기(문제 추적용) (백엔드)
├─ errors.py # 🚨📨 에러를 똑같은 모양으로 보내기 (백엔드)
├─ security.py # 🔑🛡️ 로그인 토큰/비밀번호 처리 (백엔드)

├─ api/ # 🌐🚪 밖에서 들어오는 요청을 받는 곳
│ ├─ deps.py # 🧩🔌 공통 준비물(DB연결, 로그인 유저 꺼내기) (백엔드)
│ ├─ routes/ # 📮🗺️ URL별 기능(엔드포인트)
│ │ ├─ auth.py # 🔐👤 회원가입/로그인 (백엔드)
│ │ ├─ users.py # 👤🩺 유저/건강정보 저장/조회 (백엔드 + USER Agent 담당)
│ │ ├─ products.py # 🛒📋 상품 목록/상세 조회 (백엔드)
│ │ ├─ cart.py # 🧺📦 (옵션) 장바구니 저장/조회 (CART 입력용)
│ │ └─ ai.py # 🤖🚦 ⭐ 판정/추천 요청 → orchestrator 실행 (백엔드 + Orchestrator 담당)
│ └─ schemas/ # 📦📐 요청/응답 데이터 모양(프론트와 약속)
│ ├─ auth.py # 🔐🧾 로그인/회원가입 데이터 형식 (백엔드)
│ ├─ users.py # 👤🩺 유저/건강정보 데이터 형식 (백엔드 + USER Agent 담당)
│ ├─ products.py # 🛒📦 상품 데이터 형식 (백엔드)
│ ├─ cart.py # 🧺📦 (옵션) 장바구니 데이터 형식 (CART 담당)
│ └─ ai.py # 🤖📨 판정/추천 응답 형식 (Orchestrator + Composer 담당)

├─ domain/ # 🧠📏 서비스 ‘핵심 판단/정리’ 로직(LLM 말고 코드로 확정)
│ ├─ models/ # 🧱🗃️ DB에 저장할 데이터 설계도
│ │ ├─ user.py # 👤🧱 유저 데이터 모양 (백엔드)
│ │ ├─ health_profile.py # 🩺🧱 건강정보 데이터 모양 (백엔드 + USER 담당)
│ │ ├─ guideline.py # 📏🧱 질환별 기준치/가이드 데이터 모양 (Rule 담당)
│ │ ├─ product.py # 🛒🧱 상품 데이터 모양 (백엔드)
│ │ ├─ product_nutrient.py # 🥗🧱 영양성분 데이터 모양 (백엔드)
│ │ └─ cart_item.py # 🧺🧱 (옵션) 장바구니 아이템 데이터 모양 (CART 담당)
│ ├─ services/ # 🧩🧠 “업무 로직” 함수 묶음(Agent가 호출)
│ │ ├─ user_service.py # 👤🧾 유저/건강정보를 판정용으로 정리 (USER 담당)
│ │ ├─ guideline_service.py # 📏🧾 기준치/금지 조건 정리 (Rule 담당)
│ │ ├─ product_service.py # 🛒🧾 상품 정보를 판정용으로 정리 (백엔드)
│ │ ├─ reco_service.py # 🔍🧾 “후보 상품” 넓게 모아오기 (RECO 담당)
│ │ ├─ substitution_service.py # 🔁🧾 “최종 대체안” 필터/점수/정렬/사유 (Sub 담당)
│ │ └─ cart_service.py # 🧺🧾 (옵션/MVP X) 장바구니 합산용 데이터 (CART 담당)
│ └─ rules/ # ⚖️🧷 OK/WARN/BLOCK 등 “판정 규칙”
│ ├─ rule_engine.py # 🧠⚖️ 규칙 결과 합쳐 최종 결론 (Rule 담당)
│ ├─ allergen_rules.py # 🚫🥜 알레르기/금지성분 규칙 (Rule 담당)
│ ├─ nutrient_rules.py # 🧂🍬 당/나트륨 등 수치 규칙 (Rule 담당)
│ ├─ substitution_rules.py # 🔁📊 대체안 점수/필터 규칙 (Sub+Rule 협업)
│ └─ cart_rules.py # 🧺📊 (옵션/MVP X) 장바구니 합산 규칙 (CART+Rule 협업)

├─ infra/ # 🔌🌍 “밖과 연결”(DB/Vector/Redis/LLM 등)
│ ├─ db/
│ │ ├─ session.py # 🗄️🔌 DB 연결 만들기 (백엔드)
│ │ └─ repositories/
│ │ ├─ user_repo.py # 👤🗄️ 유저 DB 저장/조회 (백엔드)
│ │ ├─ health_repo.py # 🩺🗄️ 건강정보 DB 저장/조회 (백엔드)
│ │ ├─ guideline_repo.py # 📏🗄️ 기준치 DB 저장/조회 (Rule 담당)
│ │ ├─ product_repo.py # 🛒🗄️ 상품 DB 저장/조회 (백엔드)
│ │ └─ cart_repo.py # 🧺🗄️ (옵션) 장바구니 DB 저장/조회 (CART 담당)
│ ├─ cache/ # ⚡🧠 잠깐 저장(선택)
│ │ ├─ redis_client.py # ⚡🔌 Redis 연결 (백엔드)
│ │ └─ state_store.py # 🧠🕒 최근 결과 저장(선택) (Orchestrator 담당)
│ ├─ vector/ # 🔍📚 비슷한 상품 찾기(검색 인프라)
│ │ ├─ client.py # 🔍🔌 검색 시스템 연결 (RECO 담당)
│ │ ├─ retriever.py # 🎯🔍 TopK 후보 검색 (RECO 담당)
│ │ └─ indexer.py # 🧱🧠 인덱스 만들기 (RECO 담당)
│ └─ llm/ # 🤖💬 “문장 생성/요약” 같은 LLM 기능 (Composer 담당 중심)
│ ├─ client.py # 🤖📡 LLM 요청 보내기 (Composer/LLM 담당)
│ └─ prompts/
│ ├─ composer.md # 📝🎨 팝업 문장 스타일/형식 (Composer 담당)
│ └─ system_rules.md # 📏🗣️ 공통 말하기 규칙(문장 톤/금지문구 등) (Composer+팀 합의)

└─ ai/ # 🧩🕸️ “에이전트 협업 순서/흐름”(LangGraph)
├─ state/
│ ├─ schema.py # 🧠📐 공용 메모장(칸 이름+모양) (Orchestrator 작성 + 모두 합의)
│ └─ builders.py # 🧱🛠️ state↔input/output 변환(형식 통일) (Orchestrator+백엔드 협업)
├─ contracts/
│ └─ agent_io.py # 🧾🔁 각 Agent가 읽고/쓰는 칸 목록(계약서) (Orchestrator 취합, 각 Agent 제출)
├─ tools/ # 🧰🧩 (공용) Agent들이 직접 import해서 실행하는 “도구 함수” 모음 ✅(이동)
│ ├─ init.py # 📦🧾 tool export 정리(한 곳에서 가져오기 쉽게 묶기) (공용/Orchestrator 협업)
│ ├─ user_tools.py # 👤🧰 USER Agent 도구(유저/프로필 로딩, 전처리) (USER 담당)
│ ├─ product_tools.py # 🛒🧰 상품 도구(상품/영양성분 조회, 정규화) (백엔드/RECO 협업)
│ ├─ reco_tools.py # 🔍🧰 후보 검색 도구(Vector 검색/카테고리 후보) (RECO 담당)
│ ├─ substitution_tools.py # 🔁🧰 대체안 생성 도구(필터/점수 계산/사유 생성) (Sub 담당)
│ ├─ cart_tools.py # 🧺🧰 (옵션/MVP X) 장바구니 합산/위반 도구 (CART 담당)
│ └─ rule_tools.py # ⚖️🧰 룰 엔진 실행 도구(OK/WARN/BLOCK 판정 호출) (Rule 담당)
├─ orchestrator/ # 🧭🕹️ “LLM 없이 분기 호출” 담당
│ ├─ runner.py # ▶️🧭 실행 시작/종료/에러 처리(진입점) (Orchestrator 담당)
│ ├─ policy.py # 🧠📌 결과값(state) 기반 분기 규칙(if/else) (Orchestrator 담당)
│ └─ graph.py # 🕸️🧭 LangGraph로 순서 정의-“노드와 연결”만 정의 (Orchestrator 담당)
└─ agents/  
├─ user_agent.py # 👤🧩 유저 정보를 state에 채움 (USER 담당)
├─ chat_core.py # 🧠🚦 판정/규칙 실행(“결론 값” 만들기) (CHAT Core 담당)
├─ reco_agent.py # 🔍🧩 후보 상품 넓게 찾기 (RECO 담당)
├─ substitution_agent.py # 🔁🧩 최종 대체안만 뽑기 (Substitution 담당)
├─ cart_scanner_agent.py # 🧺🧩 (옵션/MVP X) 장바구니 합산/위반 찾기 (CART 담당)
└─ composer_agent.py # 📝🧩 (LLM 사용) 최종 팝업 문장/카드 생성 (Composer 담당)